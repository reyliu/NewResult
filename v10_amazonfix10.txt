1. 
liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v10_2Embed_2MLPshare/MLP.py --learner adam --lr 0.0001 --batch_size_random 2000000 --path Data/amazonfix10/
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=2000000, epochs=20, layers='[64,32,16,8]', learner='adam', lr=0.0001, path='Data/amazonfix10/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [98.1 s]. #user=28881, #item=30133, #train_user=2599290, #train_item=7240784, #test=1277634
Time: [190.3], Init: 
Init_NDCG: [ 0.68924052  0.69045447  0.69315912  0.69690532  0.70198613  0.70729509
  0.7141167   0.72206452  0.73103435  0.74130646]
RatingInit_NDCG: [ 0.69713003  0.69843113  0.70007427  0.7027477   0.7072007   0.71248135
  0.71889038  0.72653879  0.73477157  0.74488025]
Iteration 0 [175.6 s]: rank_loss = 0.654097 [180.58 s],
NDCG: [ 0.79896633  0.79736341  0.79625184  0.79610018  0.7974404   0.79987871
  0.80341669  0.80821731  0.81405458  0.82096191]
Iteration 0 [264.2 s]: rank_loss = 0.604144 [179.29 s],
NDCG: [ 0.78229386  0.7799939   0.77936294  0.77963017  0.78092957  0.78403561
  0.7883742   0.79406551  0.8003073   0.80763641]
Iteration 1 [169.1 s]: rank_loss = 0.643539 [179.51 s],
NDCG: [ 0.78972342  0.78994123  0.79044803  0.79173149  0.79366628  0.79656054
  0.80062003  0.80536763  0.81140147  0.81869322]
Iteration 1 [306.3 s]: rank_loss = 0.589377 [178.15 s],
NDCG: [ 0.78720093  0.78559487  0.78624158  0.78680139  0.7885693   0.79176526
  0.79601182  0.80130451  0.80725609  0.8145899 ]
Iteration 2 [167.7 s]: rank_loss = 0.640789 [178.82 s],
NDCG: [ 0.78623286  0.7876031   0.78846942  0.78986045  0.79233918  0.795398
  0.79949922  0.80444701  0.81056952  0.81789868]
Iteration 2 [332.8 s]: rank_loss = 0.588270 [178.48 s],
NDCG: [ 0.78271872  0.78396357  0.78455056  0.78542325  0.78745904  0.79055623
  0.79490358  0.80013745  0.80636456  0.81356039]
Iteration 3 [168.0 s]: rank_loss = 0.640155 [179.67 s],
NDCG: [ 0.78444077  0.78667033  0.78806925  0.78951039  0.79162615  0.79522364
  0.79928659  0.80453112  0.81094546  0.81809191]
Iteration 3 [319.6 s]: rank_loss = 0.587856 [179.72 s],
NDCG: [ 0.780235    0.78076454  0.78178908  0.78358763  0.78605364  0.78936122
  0.79391178  0.79927594  0.80577169  0.81295379]
Iteration 4 [167.9 s]: rank_loss = 0.639714 [185.96 s],
NDCG: [ 0.7835698   0.78565859  0.78669066  0.78863327  0.79113824  0.79421509
  0.79885632  0.80401452  0.81025121  0.81734614]
Iteration 4 [332.6 s]: rank_loss = 0.586980 [183.04 s],
NDCG: [ 0.78068975  0.78247449  0.78398169  0.78534806  0.7880001   0.7912886
  0.79564578  0.8009113   0.80726571  0.81456625]
Iteration 5 [178.7 s]: rank_loss = 0.639014 [188.54 s],
NDCG: [ 0.78533848  0.78651166  0.78797427  0.78956386  0.7922416   0.79538517
  0.79962327  0.80443528  0.81068114  0.81792085]
Iteration 5 [329.8 s]: rank_loss = 0.586395 [185.52 s],
NDCG: [ 0.78160976  0.7828602   0.78500605  0.78628971  0.78899562  0.79232123
  0.7966498   0.80164057  0.80794162  0.81523677]
Iteration 6 [173.6 s]: rank_loss = 0.638851 [193.58 s],
NDCG: [ 0.78331848  0.78545435  0.78674781  0.78853416  0.79136429  0.79455158
  0.79908377  0.80425733  0.81028916  0.81753723]
Iteration 6 [333.7 s]: rank_loss = 0.586033 [183.18 s],
NDCG: [ 0.78150943  0.78370002  0.7848894   0.78651112  0.78922963  0.79269558
  0.79694213  0.80205353  0.80817675  0.81547958]
Iteration 7 [171.0 s]: rank_loss = 0.638334 [185.18 s],
NDCG: [ 0.7823944   0.78471998  0.78711926  0.78842314  0.79118239  0.79452752
  0.79878591  0.80395512  0.81004478  0.81736474]
Iteration 7 [337.1 s]: rank_loss = 0.585279 [179.18 s],
NDCG: [ 0.78158262  0.78293423  0.78471139  0.78650737  0.78884278  0.79241762
  0.79680736  0.80188152  0.80820962  0.81568538]
Iteration 8 [168.3 s]: rank_loss = 0.638196 [178.76 s],
NDCG: [ 0.78205605  0.78492971  0.78626876  0.78850478  0.79094275  0.7944081
  0.7988531   0.80423487  0.81018205  0.81734437]
Iteration 8 [322.7 s]: rank_loss = 0.585373 [179.44 s],
NDCG: [ 0.77975698  0.78233886  0.78401322  0.78570663  0.78863843  0.79202763
  0.79633778  0.80175913  0.80799042  0.81520725]
Iteration 9 [168.0 s]: rank_loss = 0.637948 [178.41 s],
NDCG: [ 0.78303739  0.78542924  0.78684537  0.78851523  0.79127679  0.79439049
  0.79885738  0.80432747  0.81059289  0.81766692]
Iteration 9 [321.1 s]: rank_loss = 0.585283 [178.32 s],
NDCG: [ 0.78069177  0.78324128  0.78430668  0.78621079  0.78873627  0.79230593
  0.79676445  0.80199154  0.80845089  0.81564754]
Iteration 10 [168.4 s]: rank_loss = 0.637742 [178.13 s],
NDCG: [ 0.78286056  0.78509989  0.78637615  0.78837555  0.7912868   0.79446958
  0.79894477  0.80417995  0.81039943  0.81746457]
Iteration 10 [320.8 s]: rank_loss = 0.584646 [178.50 s],
NDCG: [ 0.78142167  0.78299226  0.78417663  0.78650457  0.78902795  0.79246505
  0.7971046   0.80233264  0.80871397  0.81594415]
Iteration 11 [168.2 s]: rank_loss = 0.637731 [178.23 s],
NDCG: [ 0.7832869   0.78544925  0.78733906  0.78855243  0.79121247  0.79468338
  0.79914502  0.80456518  0.81078394  0.81786794]
Iteration 11 [320.6 s]: rank_loss = 0.584558 [178.18 s],
NDCG: [ 0.78113661  0.78290163  0.78482692  0.78657898  0.7892747   0.79286126
  0.79727025  0.80244633  0.80884018  0.81616234]
Iteration 12 [168.7 s]: rank_loss = 0.637754 [178.88 s],
NDCG: [ 0.78280439  0.78514297  0.78698027  0.78884675  0.79141988  0.79465021
  0.79910142  0.80444934  0.81048111  0.81757996]
Iteration 12 [321.8 s]: rank_loss = 0.584444 [178.73 s],
NDCG: [ 0.78235817  0.78412063  0.78601801  0.78741566  0.79002704  0.79349085
  0.79783316  0.8033094   0.80931464  0.81640729]
Iteration 13 [169.9 s]: rank_loss = 0.637473 [179.50 s],
NDCG: [ 0.78276075  0.78517582  0.78690261  0.78866532  0.79130494  0.79460461
  0.79917217  0.80414882  0.81030565  0.81749479]
Iteration 13 [323.2 s]: rank_loss = 0.584326 [179.21 s],
NDCG: [ 0.78198258  0.783496    0.78535698  0.7872691   0.78995374  0.79340857
  0.79791164  0.80284128  0.80916371  0.81631022]
Iteration 14 [169.5 s]: rank_loss = 0.637273 [179.16 s],
NDCG: [ 0.78331811  0.78520873  0.78665049  0.7885739   0.791355    0.79467816
  0.79929035  0.80433136  0.81037015  0.81764636]
Iteration 14 [322.0 s]: rank_loss = 0.584370 [179.35 s],
NDCG: [ 0.78076734  0.78418784  0.78496316  0.7871932   0.78970204  0.79317825
  0.79780259  0.80276422  0.80889222  0.81614099]
Iteration 15 [170.2 s]: rank_loss = 0.637344 [179.23 s],
NDCG: [ 0.78180296  0.7842885   0.7858737   0.78802274  0.79083191  0.79435567
  0.79877056  0.80387567  0.8100577   0.81712029]
Iteration 15 [323.5 s]: rank_loss = 0.584091 [178.43 s],
NDCG: [ 0.78076288  0.78308858  0.78525288  0.78715696  0.78998342  0.79328725
  0.79772857  0.80281166  0.80922596  0.81638181]
Iteration 16 [168.7 s]: rank_loss = 0.636951 [178.41 s],
NDCG: [ 0.78192023  0.78422842  0.78601748  0.78784661  0.79073339  0.79422125
  0.79905556  0.80402456  0.81009541  0.81718054]
Iteration 16 [321.5 s]: rank_loss = 0.583830 [178.26 s],
NDCG: [ 0.78077577  0.78296461  0.78464788  0.78665634  0.78955933  0.79304749
  0.79774424  0.80290654  0.80890152  0.81622854]
Iteration 17 [168.4 s]: rank_loss = 0.636999 [178.29 s],
NDCG: [ 0.78354186  0.78496425  0.78647229  0.7881658   0.79120263  0.79450275
  0.79909037  0.80411304  0.81035036  0.81742704]
Iteration 17 [321.3 s]: rank_loss = 0.583721 [178.36 s],
NDCG: [ 0.78096937  0.78257735  0.78462996  0.78667073  0.78949328  0.79291751
  0.79730686  0.80245692  0.80874044  0.81599271]
Iteration 18 [168.0 s]: rank_loss = 0.636751 [178.23 s],
NDCG: [ 0.78049788  0.78417334  0.78577551  0.78748852  0.79052174  0.79399797
  0.79852083  0.80355052  0.80981322  0.81703418]
Iteration 18 [323.4 s]: rank_loss = 0.583704 [179.48 s],
NDCG: [ 0.78071747  0.78279947  0.78427569  0.78630574  0.78920517  0.79272716
  0.79706877  0.80246373  0.80881004  0.81609501]
Iteration 19 [168.9 s]: rank_loss = 0.636771 [179.13 s],
NDCG: [ 0.78155122  0.78432366  0.78603631  0.78811177  0.79084328  0.7943038
  0.79866587  0.80396432  0.81016032  0.81733929]
Iteration 19 [323.0 s]: rank_loss = 0.583465 [178.23 s],
NDCG: [ 0.78045898  0.78329841  0.78477037  0.78671468  0.78945069  0.79296347
  0.79728784  0.80270903  0.80905409  0.81621248]
End. Best Iteration 0.



2. Only update for rank_u
liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v10_2Embed_2MLPshare/MLP.py --learner adam --lr 0.0001 --batch_size_random 2000000 --path Data/amazonfix10/ 
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=2000000, epochs=20, layers='[64,32,16,8]', learner='adam', lr=0.0001, path='Data/amazonfix10/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [88.9 s]. #user=28881, #item=30133, #train_user=2599290, #train_item=7240784, #test=1277634
Time: [189.7], Init: 
Init_NDCG: [ 0.68859419  0.69068865  0.69327482  0.69711602  0.70152586  0.70723559
  0.71406405  0.72193875  0.73075896  0.74103424]
RatingInit_NDCG: [ 0.69669887  0.69768387  0.70035491  0.70347162  0.70753766  0.71259037
  0.71900325  0.72643551  0.73522372  0.74535584]
Iteration 0 [173.6 s]: rank_loss = 0.654796 [176.77 s],
NDCG: [ 0.80358453  0.79873025  0.79777489  0.79750696  0.79847165  0.80065898
  0.80412376  0.80864974  0.81437929  0.82130904]
Iteration 1 [172.0 s]: rank_loss = 0.641525 [176.55 s],
NDCG: [ 0.79059948  0.79149716  0.79210019  0.79269708  0.79470506  0.79753401
  0.80162467  0.80636973  0.8122283   0.81908616]
Iteration 2 [172.9 s]: rank_loss = 0.640209 [176.52 s],
NDCG: [ 0.78706334  0.788151    0.78928374  0.79073593  0.79295062  0.79583462
  0.80014344  0.80526544  0.81122597  0.81838364]
Iteration 3 [174.5 s]: rank_loss = 0.639379 [176.95 s],
NDCG: [ 0.78580827  0.78826299  0.7894329   0.79053684  0.79274478  0.79584757
  0.79999039  0.80509202  0.81121467  0.81824663]
Iteration 4 [169.5 s]: rank_loss = 0.638914 [175.73 s],
NDCG: [ 0.78618931  0.78771333  0.78852346  0.79034733  0.79231584  0.7956981
  0.80012867  0.80501837  0.8110828   0.81828263]
Iteration 5 [170.5 s]: rank_loss = 0.638522 [175.09 s],
NDCG: [ 0.78508071  0.78685978  0.78836344  0.78976824  0.79226168  0.79504283
  0.79954107  0.80469133  0.81066507  0.81786031]
Iteration 6 [169.7 s]: rank_loss = 0.637957 [175.07 s],
NDCG: [ 0.78590224  0.78800886  0.78842004  0.79002423  0.79251693  0.79567656
  0.79993799  0.80504881  0.81088226  0.81806701]
Iteration 7 [170.0 s]: rank_loss = 0.637824 [174.82 s],
NDCG: [ 0.78491449  0.78660724  0.78816533  0.78973359  0.79228494  0.79526745
  0.79969106  0.80462927  0.81079388  0.8179817 ]
Iteration 8 [169.6 s]: rank_loss = 0.637476 [175.49 s],
NDCG: [ 0.78488867  0.78719585  0.78825829  0.78976856  0.79248601  0.79551565
  0.79997785  0.80490068  0.81102065  0.81806087]
Iteration 9 [170.9 s]: rank_loss = 0.637420 [174.87 s],
NDCG: [ 0.78358082  0.78610139  0.78765366  0.78925943  0.79218946  0.79505648
  0.79928364  0.80443273  0.81071838  0.8178756 ]
Iteration 10 [170.5 s]: rank_loss = 0.637144 [185.90 s],
NDCG: [ 0.7843179   0.7863503   0.78745901  0.78914471  0.79191981  0.79549065
  0.79950005  0.80454745  0.81068308  0.81804812]
Iteration 11 [174.7 s]: rank_loss = 0.636952 [174.80 s],
NDCG: [ 0.78361528  0.78600648  0.7872202   0.78906471  0.79148718  0.79478705
  0.79921342  0.80432051  0.81062125  0.81780291]
Iteration 12 [179.8 s]: rank_loss = 0.636891 [175.28 s],
NDCG: [ 0.78437609  0.78603781  0.7873984   0.78915133  0.79185851  0.79515511
  0.79948535  0.80466958  0.81084375  0.81803834]
Iteration 13 [177.4 s]: rank_loss = 0.636705 [175.13 s],
NDCG: [ 0.78320485  0.78543404  0.78696052  0.78877608  0.79160194  0.79495142
  0.79903804  0.80415303  0.81033906  0.81767764]
Iteration 14 [184.8 s]: rank_loss = 0.636522 [177.82 s],
NDCG: [ 0.78347508  0.78538872  0.78685622  0.78881462  0.79135071  0.79487764
  0.79927134  0.80434219  0.81045534  0.8176563 ]
Iteration 15 [221.0 s]: rank_loss = 0.636403 [191.08 s],
NDCG: [ 0.78202641  0.78523918  0.78704695  0.78859711  0.79143908  0.79441608
  0.79888891  0.80416221  0.81030738  0.81760893]
Iteration 16 [242.9 s]: rank_loss = 0.636476 [188.84 s],
NDCG: [ 0.78145618  0.78436958  0.78614269  0.78802372  0.79102969  0.79435992
  0.79863697  0.80383069  0.80996085  0.81716379]
Iteration 17 [501.0 s]: rank_loss = 0.636365 [189.49 s],
NDCG: [ 0.78145305  0.78468955  0.78624928  0.7882533   0.79099963  0.7943783
  0.79861621  0.80377039  0.81008999  0.81725999]
Iteration 18 [534.1 s]: rank_loss = 0.636302 [186.05 s],
NDCG: [ 0.78247878  0.7849153   0.78681111  0.78847231  0.79133142  0.79462069
  0.79887699  0.80392915  0.81008154  0.81735766]
Iteration 19 [527.4 s]: rank_loss = 0.636072 [185.51 s],
NDCG: [ 0.78317842  0.78545959  0.7869235   0.78842819  0.79136159  0.79471529
  0.79892603  0.80402313  0.81014902  0.81734203]
End. Best Iteration 0.

