liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v11.22_single/MLP.py --learner adam --lr 0.0001 --path Data/moviefix10/
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=256000, epochs=20, learner='adam', lr=0.0001, one_layers='[64,32,16,8]', pair_layers='[64,32,16,8]', path='Data/moviefix10/', reg_one_layers='[0,0,0,0]', reg_pair_layers='[0,0,0,0]', verbose=1) 
Load data done [85.2 s]. #user=69838, #item=8940, #train_user=1396760, #cv=349190, #test=9285378
Time: [512.2], Init: 
Init_NDCG1: [ 0.59437999  0.64715628  0.70744469  0.77517746  0.85270043]
Init_NDCG2: [ 0.59706575  0.65141     0.71298185  0.77926973  0.85461689]
Init_NDCG3: [ 0.59437999  0.64715628  0.70744469  0.77517746  0.85270043]
Init_NDCG4: [ 0.59706575  0.65141     0.71298185  0.77926973  0.85461689]
Iteration 0 [61.4 s]: ranku_loss = 1.727749 [492.32 s],
NDCG1: [ 0.66301075  0.70568256  0.75697136  0.81364437  0.87754199]
NDCG2: [ 0.55660072  0.61291363  0.67744543  0.75060261  0.83832193]
NDCG3: [ 0.66301075  0.70568256  0.75697136  0.81364437  0.87754199]
NDCG4: [ 0.55660072  0.61291363  0.67744543  0.75060261  0.83832193]
Iteration 1 [82.2 s]: ranku_loss = 0.706859 [530.37 s],
NDCG1: [ 0.70293495  0.73946975  0.78442869  0.83407246  0.89160853]
NDCG2: [ 0.52874856  0.58591903  0.65318254  0.73109905  0.82716215]
NDCG3: [ 0.70293495  0.73946975  0.78442869  0.83407246  0.89160853]
NDCG4: [ 0.52874856  0.58591903  0.65318254  0.73109905  0.82716215]
Iteration 2 [88.3 s]: ranku_loss = 0.695596 [487.77 s],
NDCG1: [ 0.72520295  0.76175015  0.80504979  0.85051515  0.90103513]
NDCG2: [ 0.49962181  0.56114811  0.63322535  0.71681362  0.81717109]
NDCG3: [ 0.72520295  0.76175015  0.80504979  0.85051515  0.90103513]
NDCG4: [ 0.49962181  0.56114811  0.63322535  0.71681362  0.81717109]
Iteration 3 [84.5 s]: ranku_loss = 0.688447 [489.31 s],
NDCG1: [ 0.74162233  0.77655865  0.81835466  0.86171485  0.90742202]
NDCG2: [ 0.55973395  0.62441354  0.69255807  0.76405393  0.84308254]
NDCG3: [ 0.74162233  0.77655865  0.81835466  0.86171485  0.90742202]
NDCG4: [ 0.55973395  0.62441354  0.69255807  0.76405393  0.84308254]
Iteration 4 [85.6 s]: ranku_loss = 0.665790 [479.54 s],
NDCG1: [ 0.75247578  0.78759985  0.82838645  0.86964795  0.9120136 ]
NDCG2: [ 0.74987554  0.78365889  0.82374036  0.86529992  0.91020796]
NDCG3: [ 0.75247578  0.78759985  0.82838645  0.86964795  0.9120136 ]
NDCG4: [ 0.74987554  0.78365889  0.82374036  0.86529992  0.91020796]
Iteration 5 [85.9 s]: ranku_loss = 0.642730 [491.19 s],
NDCG1: [ 0.75626258  0.79145126  0.8316181   0.87215314  0.91352942]
NDCG2: [ 0.75606456  0.79031625  0.83025644  0.87068197  0.9130412 ]
NDCG3: [ 0.75626258  0.79145126  0.8316181   0.87215314  0.91352942]
NDCG4: [ 0.75606456  0.79031625  0.83025644  0.87068197  0.9130412 ]
Iteration 6 [85.6 s]: ranku_loss = 0.635719 [478.19 s],
NDCG1: [ 0.75763952  0.79289944  0.83280686  0.87325587  0.91412486]
NDCG2: [ 0.75680841  0.79150207  0.83183555  0.87232876  0.91366471]
NDCG3: [ 0.75763952  0.79289944  0.83280686  0.87325587  0.91412486]
NDCG4: [ 0.75680841  0.79150207  0.83183555  0.87232876  0.91366471]
Iteration 7 [84.8 s]: ranku_loss = 0.626589 [478.30 s],
NDCG1: [ 0.75724934  0.79318336  0.8332009   0.87357171  0.91418591]
NDCG2: [ 0.7542475   0.79064111  0.83163676  0.87246311  0.91324214]
NDCG3: [ 0.75724934  0.79318336  0.8332009   0.87357171  0.91418591]
NDCG4: [ 0.7542475   0.79064111  0.83163676  0.87246311  0.91324214]
Iteration 8 [84.7 s]: ranku_loss = 0.612969 [478.14 s],
NDCG1: [ 0.757095    0.79289276  0.83324366  0.8734667   0.91411465]
NDCG2: [ 0.73958832  0.77960359  0.82391017  0.86695905  0.90873047]
NDCG3: [ 0.757095    0.79289276  0.83324366  0.8734667   0.91411465]
NDCG4: [ 0.73958832  0.77960359  0.82391017  0.86695905  0.90873047]
End. Best Model is model1.
Test_NDCG:
[ 0.7171359   0.71193742  0.70954179  0.70946405  0.71084924  0.71355642
  0.71690025  0.72088965  0.72510487  0.72957632]


liurui@ubuntu:~/DeepRec$ KERAS_BACKEND=theano python v11.22_single/MLP.py --learner adam --lr 0.0001 --path Data/moviefix10/
Using Theano backend.
MLP arguments: Namespace(batch_size=256, batch_size_random=256000, epochs=20, learner='adam', lr=0.0001, one_layers='[64,32,16,8]', pair_layers='[64,32,16,8]', path='Data/moviefix10/', reg_one_layers='[0,0,0,0]', reg_pair_layers='[0,0,0,0]', verbose=1) 
Load data done [111.0 s]. #user=69838, #item=8940, #train_user=1396760, #cv=349190, #test=9285378
Time: [450.4], Init: 
Init_NDCG1: [ 0.59956865  0.6546686   0.71599139  0.78188586  0.85594481]
Init_NDCG2: [ 0.5996631   0.65231358  0.71258503  0.77869611  0.85492433]
Init_NDCG3: [ 0.59956865  0.6546686   0.71599139  0.78188586  0.85594481]
Init_NDCG4: [ 0.5996631   0.65231358  0.71258503  0.77869611  0.85492433]
Iteration 0 [60.3 s]: ranku_loss = 1.960551 [444.63 s],
NDCG1: [ 0.71536394  0.75001109  0.79369228  0.84250581  0.89628722]
NDCG2: [ 0.72455671  0.7581735   0.80106328  0.84852443  0.89981333]
NDCG3: [ 0.71536394  0.75001109  0.79369228  0.84250581  0.89628722]
NDCG4: [ 0.72455671  0.7581735   0.80106328  0.84852443  0.89981333]
Iteration 1 [80.2 s]: ranku_loss = 0.714427 [445.20 s],
NDCG1: [ 0.72943905  0.76464735  0.80795358  0.85452575  0.90258757]
NDCG2: [ 0.528511    0.59152064  0.66167158  0.73954299  0.82954603]
NDCG3: [ 0.72943905  0.76464735  0.80795358  0.85452575  0.90258757]
NDCG4: [ 0.528511    0.59152064  0.66167158  0.73954299  0.82954603]
Iteration 2 [82.3 s]: ranku_loss = 0.683065 [444.35 s],
NDCG1: [ 0.73568504  0.77264379  0.81602594  0.8611907   0.90589367]
NDCG2: [ 0.71373796  0.74761447  0.79200596  0.84117732  0.89536656]
NDCG3: [ 0.73568504  0.77264379  0.81602594  0.8611907   0.90589367]
NDCG4: [ 0.71373796  0.74761447  0.79200596  0.84117732  0.89536656]
Iteration 3 [83.0 s]: ranku_loss = 0.670257 [444.02 s],
NDCG1: [ 0.74558295  0.78202625  0.82445563  0.8667948   0.90973906]
NDCG2: [ 0.74702432  0.77891895  0.81615184  0.85713236  0.90762706]
NDCG3: [ 0.74558295  0.78202625  0.82445563  0.8667948   0.90973906]
NDCG4: [ 0.74702432  0.77891895  0.81615184  0.85713236  0.90762706]
Iteration 4 [83.1 s]: ranku_loss = 0.659735 [445.46 s],
NDCG1: [ 0.7490456   0.78520535  0.82717749  0.86864128  0.91104614]
NDCG2: [ 0.74904265  0.77945136  0.81537298  0.85647383  0.90778256]
NDCG3: [ 0.7490456   0.78520535  0.82717749  0.86864128  0.91104614]
NDCG4: [ 0.74904265  0.77945136  0.81537298  0.85647383  0.90778256]
Iteration 5 [83.2 s]: ranku_loss = 0.655453 [444.83 s],
NDCG1: [ 0.75125049  0.78673313  0.82825483  0.86942779  0.91167789]
NDCG2: [ 0.75093017  0.78201402  0.81761226  0.85805671  0.90870889]
NDCG3: [ 0.75125049  0.78673313  0.82825483  0.86942779  0.91167789]
NDCG4: [ 0.75093017  0.78201402  0.81761226  0.85805671  0.90870889]
Iteration 6 [83.4 s]: ranku_loss = 0.653037 [445.12 s],
NDCG1: [ 0.75206098  0.78763664  0.82886105  0.87011178  0.91203822]
NDCG2: [ 0.75318297  0.78413529  0.8199073   0.85965606  0.90967987]
NDCG3: [ 0.75206098  0.78763664  0.82886105  0.87011178  0.91203822]
NDCG4: [ 0.75318297  0.78413529  0.8199073   0.85965606  0.90967987]
Iteration 7 [83.3 s]: ranku_loss = 0.650224 [462.77 s],
NDCG1: [ 0.75276913  0.78849079  0.82976064  0.87063804  0.91235522]
NDCG2: [ 0.75297893  0.78423186  0.82038717  0.85972323  0.90971507]
NDCG3: [ 0.75276913  0.78849079  0.82976064  0.87063804  0.91235522]
NDCG4: [ 0.75297893  0.78423186  0.82038717  0.85972323  0.90971507]
Iteration 8 [84.3 s]: ranku_loss = 0.645698 [452.32 s],
NDCG1: [ 0.75211917  0.78858013  0.82977604  0.87039656  0.91230475]
NDCG2: [ 0.75310926  0.78565177  0.82214169  0.86161635  0.91032261]
NDCG3: [ 0.75211917  0.78858013  0.82977604  0.87039656  0.91230475]
NDCG4: [ 0.75310926  0.78565177  0.82214169  0.86161635  0.91032261]
End. Best Model is model1.
Test_NDCG:
[ 0.71259799  0.70462599  0.70225674  0.70131676  0.70228623  0.70508707
  0.7088112   0.71285232  0.71702703  0.72163666]

